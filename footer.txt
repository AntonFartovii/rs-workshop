Some changes from first branch
